{"version":3,"sources":["assets/img/icon-close.svg","components/popup/popup.jsx","../node_modules/@babel/runtime/helpers/esm/objectWithoutProperties.js","hooks/use-escape-button.js"],"names":["_path","_extends","Object","assign","target","i","arguments","length","source","key","prototype","hasOwnProperty","call","apply","this","excluded","sourceKeys","keys","indexOf","_objectWithoutPropertiesLoose","getOwnPropertySymbols","sourceSymbolKeys","propertyIsEnumerable","SvgIconClose","_ref","svgRef","title","titleId","props","width","height","viewBox","fill","xmlns","ref","id","d","ForwardRef","connect","store","popupData","getPopupData","requiredInput","getRequiredInput","dispatch","setReview","date","closePopup","setPopupClose","setPopupData","clearPopupData","setRequiredInput","flags","useState","errorForm","setErrorForm","inputUser","useRef","useEffect","current","focus","handleFieldChange","useCallback","name","value","extend","Boolean","handleFormSubmit","evt","preventDefault","user","rating","review","definition","objectWithoutPropertiesLoose","time","String","Date","comment","callback","handleEscapeDown","Key","ESCAPE","ESC","document","addEventListener","removeEventListener","useEscapeButton","className","onClick","currentTarget","type","action","onSubmit","POPUP_INPUTS","map","item","isRequired","htmlFor","placeholder","onChange","RATING_STARS","checked","wrapper"],"mappings":"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","file":"static/js/3.21c7e882.chunk.js","sourcesContent":["var _path;\n\nfunction _extends() { _extends = Object.assign || function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; }; return _extends.apply(this, arguments); }\n\nfunction _objectWithoutProperties(source, excluded) { if (source == null) return {}; var target = _objectWithoutPropertiesLoose(source, excluded); var key, i; if (Object.getOwnPropertySymbols) { var sourceSymbolKeys = Object.getOwnPropertySymbols(source); for (i = 0; i < sourceSymbolKeys.length; i++) { key = sourceSymbolKeys[i]; if (excluded.indexOf(key) >= 0) continue; if (!Object.prototype.propertyIsEnumerable.call(source, key)) continue; target[key] = source[key]; } } return target; }\n\nfunction _objectWithoutPropertiesLoose(source, excluded) { if (source == null) return {}; var target = {}; var sourceKeys = Object.keys(source); var key, i; for (i = 0; i < sourceKeys.length; i++) { key = sourceKeys[i]; if (excluded.indexOf(key) >= 0) continue; target[key] = source[key]; } return target; }\n\nimport * as React from \"react\";\n\nfunction SvgIconClose(_ref, svgRef) {\n  var title = _ref.title,\n      titleId = _ref.titleId,\n      props = _objectWithoutProperties(_ref, [\"title\", \"titleId\"]);\n\n  return /*#__PURE__*/React.createElement(\"svg\", _extends({\n    width: 15,\n    height: 16,\n    viewBox: \"0 0 15 16\",\n    fill: \"none\",\n    xmlns: \"http://www.w3.org/2000/svg\",\n    ref: svgRef,\n    \"aria-labelledby\": titleId\n  }, props), title ? /*#__PURE__*/React.createElement(\"title\", {\n    id: titleId\n  }, title) : null, _path || (_path = /*#__PURE__*/React.createElement(\"path\", {\n    d: \"M13.6399 15.0096L7.50482 8.86495L1.36977 15.0096L0 13.6399L6.14469 7.50482L0 1.36978L1.36977 0L7.50482 6.14469L13.6399 0.00964652L15 1.36978L8.86495 7.50482L15 13.6399L13.6399 15.0096Z\",\n    fill: \"#9F9E9E\"\n  })));\n}\n\nvar ForwardRef = /*#__PURE__*/React.forwardRef(SvgIconClose);\nexport default __webpack_public_path__ + \"static/media/icon-close.17d2d705.svg\";\nexport { ForwardRef as ReactComponent };","import React, {Fragment, useRef, useEffect, useCallback, useState} from 'react';\nimport PropTypes from 'prop-types';\nimport {connect} from 'react-redux';\nimport {ReactComponent as CloseIcon} from '../../assets/img/icon-close.svg';\nimport {ReactComponent as StarIcon} from '../../assets/img/icon-star.svg';\nimport {getPopupData, getRequiredInput} from '../../store/selectors';\nimport {setPopupClose, setReview, setPopupData, setRequiredInput, clearPopupData} from '../../store/action';\nimport {useEscapeButton} from '../../hooks/use-escape-button';\nimport {RATING_STARS, POPUP_INPUTS} from '../../const';\nimport {extend} from '../../utils';\n\nconst Popup = ({\n                 popupData,\n                 requiredInput,\n                 closePopup,\n                 setReview,\n                 setPopupData,\n                 clearPopupData,\n                 setRequiredInput\n}) => {\n  const [errorForm, setErrorForm] = useState(false);\n  const inputUser = useRef(null);\n\n  useEffect(() => {\n    inputUser.current.focus();\n  },[]);\n\n  const handleFieldChange = useCallback(({name, value}) => {\n    setPopupData(extend(popupData, {[name]: value}));\n\n    if (name in requiredInput) {\n      setRequiredInput(extend(requiredInput, {[name]: Boolean(value)}))\n    }\n  }, [popupData, requiredInput, setRequiredInput, setPopupData]);\n\n  const handleFormSubmit = useCallback(\n    (evt) => {\n      evt.preventDefault();\n      const {user, rating, ...definition} = popupData;\n\n      const review = {\n        user,\n        definition,\n        rating,\n        time: String(new Date()),\n      };\n\n      if (!requiredInput.user || !requiredInput.comment) {\n        setErrorForm(true);\n        return;\n      }\n\n      setErrorForm(false);\n      setReview(review);\n      clearPopupData();\n      closePopup();\n    }, [popupData, clearPopupData, requiredInput.user, requiredInput.comment, setReview, closePopup]\n  );\n\n  const handleBlockClick = (evt) => {\n    if (evt.target === evt.currentTarget) {\n      closePopup();\n    }\n  };\n\n  useEscapeButton(closePopup);\n\n  return (\n    <div className=\"review-popup\" onClick={handleBlockClick}>\n      <div className=\"review-popup__wrapper\">\n        <h2 className=\"review-popup__title\">Оставить отзыв</h2>\n        <button className=\"review-popup__button-close\" type=\"button\" onClick={closePopup}>\n          <CloseIcon className=\"review-popup__button-icon\" />\n        </button>\n        <form\n          className={`review-popup__form form ${errorForm ? `form--error` : ``}`}\n          action=\"#\"\n          onSubmit={handleFormSubmit}\n        >\n          <div className=\"form__wrapper\">\n            <ul className=\"form__list\">\n              {POPUP_INPUTS.map((item, i) => {\n                const isRequired = item.id in requiredInput && !requiredInput[item.id];\n\n                  return (\n                    <li\n                      className={`form__item ${isRequired ? `form__item--required` : ``}`}\n                      key={i + item}\n                    >\n                      <label className=\"form__label visually-hidden\" htmlFor={item.id}>{item.title}</label>\n                      <input\n                        ref={item.id === `user` ? inputUser : null}\n                        className={`form__input ${isRequired ? `form__input--required` : ``}`}\n                        type=\"text\"\n                        id={item.id}\n                        name={item.id}\n                        value={popupData[item.id]}\n                        placeholder={item.title}\n                        onChange={(evt) => handleFieldChange(evt.target)}\n                      />\n                    </li>\n                  );\n              })}\n            </ul>\n            <ul className=\"form__list\">\n              <li className=\"form__item\">\n                <fieldset className=\"form__fieldset\">\n                  <div className=\"form__rating-wrapper\">\n                    <legend className=\"form__legend\">Оцените товар:</legend>\n                    <div className=\"form__stars-wrapper\">\n                      {RATING_STARS.map((item, i) =>\n                        <Fragment key={i + item}>\n                          <input\n                            className=\"form__input visually-hidden\"\n                            type=\"radio\"\n                            id={`star-${item}`}\n                            name=\"rating\"\n                            value={item}\n                            checked={popupData.rating === item}\n                            onChange={(evt) => handleFieldChange(evt.target)}\n                          />\n                          <label className=\"form__label form__label--star\" htmlFor={`star-${item}`}>\n                            <StarIcon className=\"form__rating-icon\" wrapper=\"span\" />\n                          </label>\n                        </Fragment>\n                      )}\n                    </div>\n                  </div>\n                </fieldset>\n              </li>\n              <li className={`form__item ${!requiredInput.comment ? `form__item--required` : ``}`}>\n                <label className=\"form__label visually-hidden\" htmlFor=\"comment\">Ввод комментария</label>\n                <textarea\n                  className={`form__textarea ${!requiredInput.comment ? `form__textarea--required` : ``}`}\n                  name=\"comment\"\n                  id=\"comment\"\n                  value={popupData.comment}\n                  placeholder=\"Комментарий\"\n                  onChange={(evt) => handleFieldChange(evt.target)}\n                />\n              </li>\n            </ul>\n          </div>\n          <button className=\"form__button-submit button button--red\" type=\"submit\">оставить отзыв</button>\n        </form>\n      </div>\n    </div>\n  );\n};\n\nPopup.propTypes = {\n  popupData: PropTypes.shape({\n    user: PropTypes.string.isRequired,\n    dignity: PropTypes.string.isRequired,\n    limitations: PropTypes.string.isRequired,\n    comment: PropTypes.string.isRequired,\n    rating: PropTypes.string.isRequired,\n  }).isRequired,\n  requiredInput: PropTypes.shape({\n    user: PropTypes.bool.isRequired,\n    comment: PropTypes.bool.isRequired,\n  }).isRequired,\n  closePopup: PropTypes.func.isRequired,\n  setReview: PropTypes.func.isRequired,\n  setPopupData: PropTypes.func.isRequired,\n  clearPopupData: PropTypes.func.isRequired,\n  setRequiredInput: PropTypes.func.isRequired,\n};\n\nconst mapStateToProps = (store) => ({\n  popupData: getPopupData(store),\n  requiredInput: getRequiredInput(store),\n});\n\nconst mapDispatchToProps = (dispatch) => ({\n  setReview(date) {\n    dispatch(setReview(date));\n  },\n  closePopup() {\n    dispatch(setPopupClose());\n  },\n  setPopupData(date) {\n    dispatch(setPopupData(date));\n  },\n  clearPopupData() {\n    dispatch(clearPopupData());\n  },\n  setRequiredInput(flags) {\n    dispatch(setRequiredInput(flags));\n  },\n});\n\nexport default connect(mapStateToProps, mapDispatchToProps)(Popup);\n","import objectWithoutPropertiesLoose from \"@babel/runtime/helpers/esm/objectWithoutPropertiesLoose\";\nexport default function _objectWithoutProperties(source, excluded) {\n  if (source == null) return {};\n  var target = objectWithoutPropertiesLoose(source, excluded);\n  var key, i;\n\n  if (Object.getOwnPropertySymbols) {\n    var sourceSymbolKeys = Object.getOwnPropertySymbols(source);\n\n    for (i = 0; i < sourceSymbolKeys.length; i++) {\n      key = sourceSymbolKeys[i];\n      if (excluded.indexOf(key) >= 0) continue;\n      if (!Object.prototype.propertyIsEnumerable.call(source, key)) continue;\n      target[key] = source[key];\n    }\n  }\n\n  return target;\n}","import {useEffect, useCallback} from 'react';\nimport {Key} from '../const';\n\nexport const useEscapeButton = (callback) => {\n  const handleEscapeDown = useCallback((evt) => {\n    if (evt.key === Key.ESCAPE || evt.key === Key.ESC) {\n      callback();\n    }\n  }, [callback]);\n\n  useEffect(() => {\n    document.addEventListener(`keydown`, handleEscapeDown);\n\n    return () => document.removeEventListener(`keydown`, handleEscapeDown);\n  }, [handleEscapeDown]);\n};\n"],"sourceRoot":""}